<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculate Grid App </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 13px;
            background: #0d0d0d;
            color: #d0d0d0;
            padding: 8px;
        }
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: #1a1a1a;
            border-radius: 6px;
            padding: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.8);
            border: 1px solid #2a2a2a;
        }
        h2 {
            font-size: 18px;
            margin-bottom: 10px;
            color: #5cb3ff;
            text-align: center;
        }
        .section {
            margin-bottom: 10px;
            padding: 8px;
            background: #141414;
            border-radius: 4px;
            border: 1px solid #2a2a2a;
        }
        .input-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 5px 0;
            font-size: 12px;
        }
        label {
            flex: 1;
            color: #a0a0a0;
        }
        input {
            width: 110px;
            padding: 5px 10px;
            background: #0d0d0d;
            border: 1px solid #333;
            border-radius: 3px;
            color: #d0d0d0;
            font-size: 12px;
        }
        input:focus {
            outline: none;
            border-color: #5cb3ff;
            background: #151515;
        }
        .result {
            display: flex;
            justify-content: space-between;
            margin: 4px 0;
            padding: 5px 10px;
            background: #0f0f0f;
            border-radius: 3px;
            font-size: 12px;
            border: 1px solid #222;
        }
        .result-label {
            color: #777;
        }
        .result-value {
            color: #5cb3ff;
            font-weight: bold;
        }
        .divider {
            height: 1px;
            background: #2a2a2a;
            margin: 6px 0;
        }
        .section-title {
            font-size: 13px;
            color: #e0e0e0;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .rounds-table-container {
            max-height: 400px;
            overflow-x: auto;
            overflow-y: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            background: #141414;
        }
        thead {
            position: sticky;
            top: 0;
            z-index: 10;
        }
        th {
            background: #1a1a1a;
            color: #5cb3ff;
            padding: 10px 8px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #2a2a2a;
            white-space: nowrap;
            font-size: 11px;
        }
        td {
            padding: 8px;
            border: 1px solid #2a2a2a;
            color: #d0d0d0;
            background: #0f0f0f;
            text-align: right;
            font-size: 11px;
        }
        tbody tr:nth-child(even) {
            background: #141414;
        }
        tbody tr:hover {
            background: #1a1a1a;
        }
        .round-number {
            background: #252525 !important;
            color: #5cb3ff;
            font-weight: bold;
            text-align: center;
        }
        .num-rounds-input {
            margin-bottom: 6px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Calculate Grid App</h2>
        
        <div class="section">
            <div class="section-title">Inputs</div>
            <div class="input-group">
                <label>Entry THB:</label>
                <input type="number" id="cv" value="34" step="0.01">
            </div>
            <div class="input-group">
                <label>Entry USD:</label>
                <input type="number" id="entry" value="14" step="0.01">
            </div>
            <div class="input-group">
                <label>ทุนทั้งหมด:</label>
                <input type="number" id="startpTH" value="90000" step="1">
            </div>
            <div class="input-group">
                <label>จุดซื้อลงมาทุกๆ %:</label>
                <input type="number" id="downEntry" value="0.5" step="0.01">
            </div>
            <div class="input-group">
                <label>รองรับการล่วง%:</label>
                <input type="number" id="supportDrawdown" value="80" step="0.01">
            </div>
            <div class="input-group">
                <label>ทำกำไร %:</label>
                <input type="number" id="pf" value="1.4" step="0.01">
            </div>
            <div class="input-group">
                <label>Number Order:</label>
                <input type="number" id="numberOrder" value="78" step="1">
            </div>
            <div class="input-group">
                <label>จำนวนวันที่คำนวน:</label>
                <input type="number" id="perday" value="4" step="1">
            </div>
            <div class="input-group num-rounds-input">
                <label>รอบเดือน:</label>
                <input type="number" id="numRounds" value="12" step="1" min="1">
            </div>
        </div>

        <div class="divider"></div>

        <div class="section">
            <div class="section-title">Price Calculations</div>
            <div class="result">
                <span class="result-label">Startp USD:</span>
                <span class="result-value" id="startpUSD">0</span>
            </div>
            <div class="result">
                <span class="result-label">จำนวนOrderที่รองรับ:</span>
                <span class="result-value" id="pd">0</span>
            </div>
            <div class="result">
                <span class="result-label">DD is USD:</span>
                <span class="result-value" id="ddUSD">0</span>
            </div>
            <div class="result">
                <span class="result-label">DD is THB:</span>
                <span class="result-value" id="ddTHB">0</span>
            </div>
        </div>

        <div class="divider"></div>

        <div class="section">
            <div class="section-title">Entry & Total</div>
            <div class="result">
                <span class="result-label">Entry TH:</span>
                <span class="result-value" id="entryTH">0</span>
            </div>
            <div class="result">
                <span class="result-label">TT_PF:</span>
                <span class="result-value" id="ttPF">0</span>
            </div>
            <div class="result">
                <span class="result-label">ทุน+กำไรต่อไม้:</span>
                <span class="result-value" id="tt">0</span>
            </div>
            <div class="result">
                <span class="result-label">กำไรเท่านั้น:</span>
                <span class="result-value" id="total">0</span>
            </div>
        </div>

        <div class="divider"></div>

        <div class="section">
            <div class="section-title">Per Day Calculation</div>
            <div class="result">
                <span class="result-label">จำนวนรอบในเดือน:</span>
                <span class="result-value" id="day1Ratio">0</span>
            </div>
            <div class="result">
                <span class="result-label">กำไรรวมทั้งเดือน:</span>
                <span class="result-value" id="day1Total">0</span>
            </div>
        </div>

        <div class="divider"></div>

        <div class="section">
            <div class="section-title">Rounds Calculation Table</div>
            <div class="rounds-table-container">
                <table id="roundsTable">
                    <thead>
                        <tr>
                            <th>Round</th>
                            <th>Entry USD</th>
                            <th>ทุนทั้งหมด</th>
                            <th>Startp USD</th>
                            <th>DD USD</th>
                            <th>DD THB</th>
                            <th>Entry THB</th>
                            <th>TT_PF</th>
                            <th>ทุน+กำไรต่อไม้</th>
                            <th>กำไรเท่านั้น</th>
                            <th>จำนวนรอบในเดือน</th>
                            <th>กำไรรวมทั้งเดือน</th>
                        </tr>
                    </thead>
                    <tbody id="roundsTableBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        function calculateRound(cv, entry, startpTH, downEntry, supportDrawdown, pf, numberOrder, perday) {
            // Price Calculations
            const startpUSD = startpTH / cv;
            const pd = supportDrawdown / downEntry;
            const ddUSD = startpUSD / pd;
            const ddTHB = ddUSD * cv;

            // Entry & Total Calculations
            const entryTH = entry * cv;
            const ttPF = entryTH / 100 * pf;
            const tt = entryTH + ttPF;
            const total = ttPF * numberOrder;

            // Per Day Calculations
            const day1Ratio = 30 / perday;
            const day1Total = day1Ratio * total;

            return {
                startpUSD,
                pd,
                ddUSD,
                ddTHB,
                entryTH,
                ttPF,
                tt,
                total,
                day1Ratio,
                day1Total,
                entry,
                startpTH
            };
        }

        function calculate() {
            // Get input values
            const cv = parseFloat(document.getElementById('cv').value) || 0;
            let entry = parseFloat(document.getElementById('entry').value) || 0;
            let startpTH = parseFloat(document.getElementById('startpTH').value) || 0;
            const downEntry = parseFloat(document.getElementById('downEntry').value) || 0;
            const supportDrawdown = parseFloat(document.getElementById('supportDrawdown').value) || 80;
            const pf = parseFloat(document.getElementById('pf').value) || 0;
            const numberOrder = parseFloat(document.getElementById('numberOrder').value) || 0;
            const perday = parseFloat(document.getElementById('perday').value) || 1;
            const numRounds = parseInt(document.getElementById('numRounds').value) || 1;

            // Calculate first round (using original values)
            const firstRound = calculateRound(cv, entry, startpTH, downEntry, supportDrawdown, pf, numberOrder, perday);

            // Update main display with first round
            document.getElementById('startpUSD').textContent = firstRound.startpUSD.toFixed(2);
            document.getElementById('pd').textContent = firstRound.pd.toFixed(2);
            document.getElementById('ddUSD').textContent = firstRound.ddUSD.toFixed(2);
            document.getElementById('ddTHB').textContent = firstRound.ddTHB.toFixed(2);
            document.getElementById('entryTH').textContent = firstRound.entryTH.toFixed(2);
            document.getElementById('ttPF').textContent = firstRound.ttPF.toFixed(2);
            document.getElementById('tt').textContent = firstRound.tt.toFixed(2);
            document.getElementById('total').textContent = firstRound.total.toFixed(2);
            document.getElementById('day1Ratio').textContent = firstRound.day1Ratio.toFixed(2);
            document.getElementById('day1Total').textContent = firstRound.day1Total.toFixed(2);

            // Calculate and display all rounds in table
            const roundsTableBody = document.getElementById('roundsTableBody');
            roundsTableBody.innerHTML = '';

            let currentEntry = entry;
            let currentStartpTH = startpTH;
            const allRounds = [];

            // Calculate all rounds
            for (let i = 0; i < numRounds; i++) {
                if (i === 0) {
                    // First round uses original values
                    allRounds.push(firstRound);
                } else {
                    // Use DD is USD from previous round as Entry ($)
                    currentEntry = allRounds[i - 1].ddUSD;
                    // Add Day 1 Total from previous round to Startp TH
                    currentStartpTH = currentStartpTH + allRounds[i - 1].day1Total;

                    const roundResult = calculateRound(cv, currentEntry, currentStartpTH, downEntry, supportDrawdown, pf, numberOrder, perday);
                    allRounds.push(roundResult);
                }
            }

            // Display all rounds in table
            allRounds.forEach((round, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="round-number">${index + 1}</td>
                    <td>${round.entry.toFixed(2)}</td>
                    <td>${round.startpTH.toFixed(2)}</td>
                    <td>${round.startpUSD.toFixed(2)}</td>
                    <td>${round.ddUSD.toFixed(2)}</td>
                    <td>${round.ddTHB.toFixed(2)}</td>
                    <td>${round.entryTH.toFixed(2)}</td>
                    <td>${round.ttPF.toFixed(2)}</td>
                    <td>${round.tt.toFixed(2)}</td>
                    <td>${round.total.toFixed(2)}</td>
                    <td>${round.day1Ratio.toFixed(2)}</td>
                    <td>${round.day1Total.toFixed(2)}</td>
                `;
                roundsTableBody.appendChild(row);
            });
        }

        // Add event listeners to all inputs
        const inputs = document.querySelectorAll('input');
        inputs.forEach(input => {
            input.addEventListener('input', calculate);
        });

        // Initial calculation
        calculate();
    </script>
</body>
</html>
